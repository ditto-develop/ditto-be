{
  "openapi": "3.0.0",
  "paths": {
    "/api/health-check": {
      "get": {
        "operationId": "AppController_getHello",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "App"
        ]
      }
    },
    "/api/users/start": {
      "post": {
        "operationId": "UsersController_start",
        "parameters": [
          {
            "name": "referredBy",
            "required": false,
            "in": "query",
            "description": "추천 받은 코드 값",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessApiResponse"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/StartResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/FailApiResponse"
                    },
                    {
                      "properties": {
                        "errorCode": {
                          "example": "INTERNAL_SERVER_ERROR"
                        },
                        "errMessage": {
                          "example": "서버 내부 오류"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "무정보 가입 및 jwt 발급 API",
        "tags": [
          "Users"
        ]
      }
    },
    "/api/users/email": {
      "patch": {
        "operationId": "UsersController_updateEmail",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RegisterEmailRequestDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessApiResponse"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/RegisterEmailResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/FailApiResponse"
                    },
                    {
                      "properties": {
                        "errorCode": {
                          "example": "UNAUTHORIZED"
                        },
                        "errMessage": {
                          "example": "사용자 인증 실패"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/FailApiResponse"
                    },
                    {
                      "properties": {
                        "errorCode": {
                          "example": "INTERNAL_SERVER_ERROR"
                        },
                        "errMessage": {
                          "example": "서버 내부 오류"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "security": [
          {
            "access-token": []
          }
        ],
        "summary": "이메일 저장 API",
        "tags": [
          "Users"
        ]
      }
    },
    "/api/game/{round}/questions": {
      "get": {
        "operationId": "GameController_getQuestions",
        "parameters": [
          {
            "name": "round",
            "required": true,
            "in": "path",
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessApiResponse"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/GameDto"
                          }
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/FailApiResponse"
                    },
                    {
                      "properties": {
                        "errorCode": {
                          "example": "UNKNOWN ERROR"
                        },
                        "errMessage": {
                          "example": "반환 가능한 질문이 없음. (데이터가 없을 때)"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/FailApiResponse"
                    },
                    {
                      "properties": {
                        "errorCode": {
                          "example": "INTERNAL_SERVER_ERROR"
                        },
                        "errMessage": {
                          "example": "서버 내부 오류"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "라운드 질문 조회",
        "tags": [
          "Game"
        ]
      }
    },
    "/api/game/{round}/questions/{questionId}": {
      "get": {
        "operationId": "GameController_getQuestion",
        "parameters": [
          {
            "name": "round",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "questionId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessApiResponse"
                    },
                    {
                      "properties": {
                        "data": null
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "라운드 질문 단일 조회 (임시 - 사용할지 안할지 모르겠음)",
        "tags": [
          "Game"
        ]
      }
    },
    "/api/game/{round}/questions/{questionId}/answer": {
      "post": {
        "operationId": "GameController_submitAnswers",
        "parameters": [
          {
            "name": "round",
            "required": true,
            "in": "path",
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "questionId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AnswerItem"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessApiResponse"
                    },
                    {
                      "properties": {
                        "data": null
                      }
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/FailApiResponse"
                    },
                    {
                      "properties": {
                        "errorCode": {
                          "example": "UNAUTHORIZED"
                        },
                        "errMessage": {
                          "example": "사용자 인증 실패"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/FailApiResponse"
                    },
                    {
                      "properties": {
                        "errorCode": {
                          "example": "UNKNOWN ERROR"
                        },
                        "errMessage": {
                          "example": "존재하지 않은 질문"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/FailApiResponse"
                    },
                    {
                      "properties": {
                        "errorCode": {
                          "example": "INTERNAL_SERVER_ERROR"
                        },
                        "errMessage": {
                          "example": "서버 내부 오류"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "security": [
          {
            "access-token": []
          }
        ],
        "summary": "단일 질문 답안 제출",
        "tags": [
          "Game"
        ]
      }
    },
    "/api/match/similar-user-count": {
      "get": {
        "operationId": "MatchController_getSimilarUsersCount",
        "parameters": [
          {
            "name": "matchRate",
            "required": false,
            "in": "query",
            "description": "매치율 (x%)",
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessApiResponse"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/SimilarUsersCountResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/FailApiResponse"
                    },
                    {
                      "properties": {
                        "errorCode": {
                          "example": "UNAUTHORIZED"
                        },
                        "errMessage": {
                          "example": "사용자 인증 실패"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/FailApiResponse"
                    },
                    {
                      "properties": {
                        "errorCode": {
                          "example": "INTERNAL_SERVER_ERROR"
                        },
                        "errMessage": {
                          "example": "서버 내부 오류"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "security": [
          {
            "access-token": []
          }
        ],
        "summary": "x% 이상 일치한 사용자 수 조회 API",
        "tags": [
          "Match"
        ]
      }
    },
    "/api/match/result-rarity": {
      "get": {
        "operationId": "MatchController_calculateResultRarity",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessApiResponse"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/CalculateResultRarityResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/FailApiResponse"
                    },
                    {
                      "properties": {
                        "errorCode": {
                          "example": "UNAUTHORIZED"
                        },
                        "errMessage": {
                          "example": "사용자 인증 실패"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/FailApiResponse"
                    },
                    {
                      "properties": {
                        "errorCode": {
                          "example": "INTERNAL_SERVER_ERROR"
                        },
                        "errMessage": {
                          "example": "서버 내부 오류"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "security": [
          {
            "access-token": []
          }
        ],
        "summary": "게임 결과 희귀도 계산 API",
        "tags": [
          "Match"
        ]
      }
    }
  },
  "info": {
    "title": "Ditto API",
    "description": "Start Game -> Solve Quiz -> Match Results -> Save Email -> Share (MVP)",
    "version": "0.1.4",
    "contact": {}
  },
  "tags": [],
  "servers": [
    {
      "url": "http://localhost:3000"
    },
    {
      "url": "http://localhost:4000"
    },
    {
      "url": "https://ditto-dev.duckdns.org"
    }
  ],
  "components": {
    "securitySchemes": {
      "access-token": {
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "type": "http"
      }
    },
    "schemas": {
      "FailApiResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "요청 성공 여부",
            "example": false
          },
          "errMessage": {
            "type": "string",
            "description": "에러 메시지",
            "example": "요청에 실패했습니다."
          },
          "errorCode": {
            "type": "string",
            "description": "에러 코드"
          }
        }
      },
      "SuccessApiResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "요청 성공 여부",
            "example": true
          },
          "data": {
            "type": "object",
            "nullable": true
          }
        }
      },
      "CreateUserResponseDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "유저 고유 ID",
            "example": "0OGits4pGmyQOvGxM_sWc",
            "format": "nanoid"
          }
        },
        "required": [
          "id"
        ]
      },
      "StartResponseDto": {
        "type": "object",
        "properties": {
          "user": {
            "description": "사용자 정보",
            "allOf": [
              {
                "$ref": "#/components/schemas/CreateUserResponseDto"
              }
            ]
          },
          "referralLink": {
            "type": "string",
            "description": "추천인 링크",
            "example": "https://example.com/r/xxxxxxxxxxxxx"
          }
        },
        "required": [
          "user",
          "referralLink"
        ]
      },
      "RegisterEmailResponseDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "유저 고유 ID",
            "example": "0OGits4pGmyQOvGxM_sWc",
            "format": "nanoid"
          },
          "email": {
            "type": "string",
            "description": "이메일",
            "example": "user@example.com",
            "format": "email"
          }
        },
        "required": [
          "id",
          "email"
        ]
      },
      "RegisterEmailRequestDto": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "description": "이메일",
            "example": "user@example.com",
            "format": "email"
          }
        },
        "required": [
          "email"
        ]
      },
      "GameOptionDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "게임 선택지 고유 ID",
            "example": "CTzutvokA-G0gERxCvjBz",
            "format": "nanoid"
          },
          "index": {
            "type": "number",
            "description": "선택지 순서 (0 또는 1)"
          },
          "label": {
            "type": "string",
            "description": "선택지 텍스트"
          }
        },
        "required": [
          "id",
          "index",
          "label"
        ]
      },
      "GameDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "게임 고유 ID",
            "example": "WtlX5D7ETO9-D4oICo99o",
            "format": "nanoid"
          },
          "text": {
            "type": "string",
            "description": "질문 텍스트",
            "example": "커피 vs 차"
          },
          "round": {
            "type": "number",
            "description": "라운드 번호",
            "example": 1
          },
          "options": {
            "description": "선택지 (항상 2개여야 함)",
            "example": [
              {
                "id": "0dgeaSSr_7TqeRs7QlatB",
                "index": 0,
                "label": "커피"
              },
              {
                "id": "o1bpDgfj7Lwf8ugVXETch",
                "index": 1,
                "label": "차"
              }
            ],
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/GameOptionDto"
            }
          },
          "index": {
            "type": "number",
            "description": "게임 순서",
            "example": 1
          }
        },
        "required": [
          "id",
          "text",
          "round",
          "options",
          "index"
        ]
      },
      "AnswerItem": {
        "type": "object",
        "properties": {
          "selectedIndex": {
            "type": "number",
            "description": "선택지의 순서번호"
          }
        },
        "required": [
          "selectedIndex"
        ]
      },
      "SimilarUsersCountResponseDto": {
        "type": "object",
        "properties": {
          "count": {
            "type": "number",
            "description": "x% 일치한 사용자 수",
            "example": 3
          }
        },
        "required": [
          "count"
        ]
      },
      "CalculateResultRarityResponseDto": {
        "type": "object",
        "properties": {
          "rarity": {
            "type": "number",
            "description": "희귀도(%)",
            "example": 15
          }
        },
        "required": [
          "rarity"
        ]
      }
    }
  }
}